<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Pet App{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
      :root {
          --sidebar-width-expanded-percentage: 13%; /* Defined by your grid */
          --sidebar-actual-width-narrow: 70px;   /* Fixed pixel width for narrow main sidebar */
          --search-panel-width: 397px;          /* Width of the new search panel */
      }

      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        overflow-x: hidden; 
      }
      .app-container {
        display: grid;
        grid-template-columns: var(--sidebar-width-expanded-percentage) 1fr; 
        height: 100vh;
        width: 100vw;
        background: #f9f9f9;
        /* Transition for grid column if we were to animate it - more complex */
        /* transition: grid-template-columns 0.35s ease-in-out; */
      }
      /* If the grid column itself needs to change for narrow sidebar */
      /* .app-container.sidebar-narrow-active {
        grid-template-columns: var(--sidebar-actual-width-narrow) 1fr;
      } */

      .sidebar-column {
        height: 100vh; 
        position: relative; /* For z-index stacking if needed */
        z-index: 1000; /* Ensure sidebar UI is above search panel if they could overlap during transition */
      }
      .main-content {
        padding: 25px;
        overflow-y: auto; 
        height: 100vh; 
        box-sizing: border-box; 
        /* Example: Adjust margin if sidebar column itself doesn't change width but content inside it does */
        /* margin-left: 0; /* Initial */
        /* transition: margin-left 0.35s ease-in-out; */
      }
      /* Example: if main content needs to react to sidebar visual width change */
      /* body.sidebar-narrow .main-content {
          margin-left: calc(var(--sidebar-actual-width-narrow) - var(--sidebar-width-expanded-percentage)); /* Complex to get right */
      /* } */


    /* Styles for the NEW Slide-Out Search Panel (can also be in sidebar.html or a dedicated CSS file) */
    .search-panel {
        position: fixed;
        top: 0;
        left: var(--sidebar-actual-width-narrow); /* Positioned to the right of where the NARROW sidebar will be */
        width: var(--search-panel-width);
        height: 100vh;
        background-color: #FFFFFF;
        border-right: 1px solid #DBDBDB;
        box-shadow: 4px 0 12px rgba(0,0,0,0.05);
        z-index: 999; /* Below main sidebar if main sidebar has higher z-index */
        display: flex;
        flex-direction: column;
        padding: 20px;
        box-sizing: border-box;
        transform: translateX(calc(-1 * var(--search-panel-width))); /* Initially hidden to the left */
        transition: transform 0.35s ease-in-out;
    }
    .search-panel.active {
        transform: translateX(0); /* Slide into view */
    }
    .search-panel-header { padding: 10px 0 20px 0; }
    .search-panel-header h2 { margin: 0; font-size: 1.8rem; font-weight: 600; color: #262626; }
    .search-panel-input-container { margin-bottom: 20px; }
    .search-panel-input-container input[type="text"] { width: 100%; padding: 10px 15px; border: 1px solid #DBDBDB; background-color: #EFEFEF; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
    .search-panel-input-container input[type="text"]:focus { outline: none; border-color: #A8A8A8; background-color: #FFFFFF; }
    .search-panel-recents .recents-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .search-panel-recents .recents-header strong { font-size: 1rem; font-weight: 600; color: #262626; }
    .search-panel-recents .recents-header button { background: none; border: none; color: #0095F6; font-weight: 600; cursor: pointer; padding: 0; }
    #recentSearchesList { list-style-type: none; padding: 0; margin: 0; }
    #recentSearchesList li { display: flex; align-items: center; padding: 8px 0; cursor: pointer; }
    #recentSearchesList li:hover { background-color: #FAFAFA; }
    .recent-avatar { width: 44px; height: 44px; border-radius: 50%; margin-right: 12px; object-fit: cover; background-color: #DBDBDB; }
    .recent-info { flex-grow: 1; }
    .recent-username { display: block; font-weight: 600; font-size: 0.9rem; color: #262626; }
    .recent-subtext { display: block; font-size: 0.85rem; color: #8E8E8E; }
    .recent-remove { background: none; border: none; font-size: 1.5rem; color: #8E8E8E; cursor: pointer; padding: 5px; }
    #liveSearchResultsContainer { margin-top: 20px; }
    #liveSearchResultsContainer ul#resultsList { list-style-type: none; padding:0; margin:0; }
    #liveSearchResultsContainer ul#resultsList li { padding: 8px 0px; font-size: 0.9rem; cursor: pointer; }
    #liveSearchResultsContainer ul#resultsList li:hover { background-color: #f0f0f0; }

    </style>
    {% block head_extra %}{% endblock %}
</head>
<body>
  <div class="app-container">
    <div class="sidebar-column">
      {% include "sidebar.html" %}
    </div>
    <div class="main-content">
      {% block content %}
      {% endblock %}
    </div>
  </div>

  <div id="searchPanel" class="search-panel">
      <div class="search-panel-header">
          <h2>Search</h2>
      </div>
      <div class="search-panel-input-container">
          <input type="text" id="panelSearchInput" placeholder="Search">
      </div>
      <div class="search-panel-recents">
          <div class="recents-header">
              <strong>Recent</strong>
              <button id="clearRecentsButton">Clear all</button>
          </div>
          <ul id="recentSearchesList">
              <li><img src="https://via.placeholder.com/44" alt="avatar" class="recent-avatar"><div class="recent-info"><span class="recent-username">houseofhighlights</span><span class="recent-subtext">House of Highlights • Following</span></div><button class="recent-remove">×</button></li>
              <li><img src="https://via.placeholder.com/44" alt="avatar" class="recent-avatar"><div class="recent-info"><span class="recent-username">ted.lasso.official</span><span class="recent-subtext">Ted Lasso</span></div><button class="recent-remove">×</button></li>
              <li><img src="https://via.placeholder.com/44/0000FF/808080?Text=A" alt="avatar" class="recent-avatar"><div class="recent-info"><span class="recent-username">apple</span><span class="recent-subtext">Apple • 34.2M followers</span></div><button class="recent-remove">×</button></li>
          </ul>
      </div>
      <div id="liveSearchResultsContainer">
          <ul id="resultsListPanel"></ul> </div>
  </div>

</body>
</html>