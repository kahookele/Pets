{% extends "base.html" %}

{% block title %}Messages | Pet App{% endblock %}

{% block content %}


<h2>Conversation: {{ conversation_id }}</h2>
<div id="chat-box">
    {% for message in messages %}
        <p>
            <strong>{{ message.sender_name }}</strong>:
            {{ message.text }}
            {% if message.edited %}<em>(edited)</em>{% endif %}
            <small>{{ message.timestamp }}</small>
            {% if session['user_uid'] == message.sender_uid %}
                <form method="post" action="{{ url_for('delete_message', conversation_id=conversation_id, message_id=message.id) }}" style="display:inline">
                    <button type="submit">Delete</button>
                </form>
                <form method="post" action="{{ url_for('edit_message', conversation_id=conversation_id, message_id=message.id) }}" style="display:inline">
                    <input type="text" name="new_text" placeholder="Edit message" required>
                    <button type="submit">Update</button>
                </form>
            {% endif %}
        </p>
    {% endfor %}
</div>
<form method="post">
    <input type="text" name="message" placeholder="Type your message..." required>
    <button type="submit">Send</button>
</form>

{% endblock %}